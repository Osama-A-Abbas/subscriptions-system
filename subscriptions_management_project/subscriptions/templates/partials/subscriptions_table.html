<div class="table-responsive">
  <table class="table table-hover">
    <thead>
      <tr>
        <th>Name</th>
        <th>Cost</th>
        <th>Billing Cycle</th>
        <th>Starting Date</th>
        <th>Next Renewal</th>
        <th>Auto Renewal</th>
        <th>Category</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for subscription in subscriptions %}
      <tr
        class="{% if subscription.is_renewing_within %}table-warning{% endif %}"
      >
        <td>{{ subscription.name }}</td>
        <td>
        {% if subscription.billing_cycle == 'monthly' %}
        ${{ subscription.monthly_cost|floatformat:2 }}/month
        {% else %} 
        ${{ subscription.yearly_cost|floatformat:2 }}/year
        {% endif %}
        </td>
        <td>
          <span
            class="badge bg-{% if subscription.billing_cycle == 'monthly' %}primary{% else %}success{% endif %}"
          >
            {{ subscription.billing_cycle|title }}
          </span>
        </td>
        <td>{{ subscription.start_date|date:"M d, Y" }}</td>
        <td>
          {{ subscription.renewal_date|date:"M d, Y" }}
          {% if subscription.is_renewing_within %}
            <span class="badge bg-warning text-dark ms-2">
                Renews in {{ subscription.days_until_renewal }} days
            </span>
          {% endif %}
        </td>
        <td>
          {% include 'partials/badge_boolean.html' with value=subscription.auto_renewal true_label='Enabled' false_label='Disabled' %}
        </td>
        <td>{{ subscription.category.name|default:"No Category" }}</td>
        <td>
          {% include 'partials/badge_boolean.html' with value=subscription.is_active true_label='Active' false_label='Inactive' %}
        </td>
        <td>
          <a
            href="{% url 'subscription_detail' subscription.pk %}"
            class="btn btn-sm btn-outline-primary"
          >
            <i class="fas fa-eye"></i>
          </a>
          <a
            href="{% url 'edit_subscription' subscription.pk %}"
            class="btn btn-sm btn-outline-warning"
          >
            <i class="fas fa-edit"></i>
          </a>
          <button
            type="button"
            class="btn btn-sm btn-outline-danger"
            onclick="confirmDelete({{ subscription.pk }}, '{{ subscription.name }}')"
          >
            <i class="fas fa-trash"></i>
          </button>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
