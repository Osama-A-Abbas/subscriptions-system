{% extends 'base.html' %} {% load static %} {% load form_extras %} {% block title %}Edit {{ subscription.name }} - Subscription Manager{% endblock %} {% block content %}
<div class="row justify-content-center">
  <div class="col-md-8 col-lg-6">
    <div class="card shadow">
      <div class="card-header bg-warning text-dark">
        <h4><i class="fas fa-edit me-2"></i>Edit Subscription</h4>
      </div>
      <div class="card-body">
        <form method="post">
          {% csrf_token %}

          <!-- Basic Information -->
          <div class="row">
            {% include 'partials/form_field.html' with field=form.name col_size=12 %}
          </div>

          <!-- Cost Information -->
          <div class="row">
            {% include 'partials/form_field.html' with field=form.monthly_cost col_size=6 %} 
            {% include 'partials/form_field.html' with field=form.yearly_cost col_size=6 %}
          </div>

          <!-- Billing and Date Information -->
          <div class="row">
            {% include 'partials/form_field.html' with field=form.billing_cycle col_size=6 %}
            {% include 'partials/form_field.html' with field=form.start_date col_size=6 %}
          </div>

          <!-- Duration Fields -->
          {% include 'partials/duration_fields.html' with form=form %}

          <!-- Category and Auto Renewal -->
          <div class="row">
            {% include 'partials/form_field.html' with field=form.category col_size=6 %}
            {% include 'partials/checkbox_field.html' with field=form.auto_renewal col_size=6 %}
          </div>

          <!-- Form Actions -->
          <div class="d-grid gap-2 d-md-flex justify-content-md-end">
            <a
              href="{% url 'subscription_detail' subscription.pk %}"
              class="btn btn-secondary me-md-2"
            >
              Cancel
            </a>
            <button
              type="button"
              class="btn btn-warning"
              id="submit-confirmation-trigger"
              data-modal-id="confirmScheduleChange"
            >
              <i class="fas fa-save me-1"></i>Update Subscription
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Confirmation Modal -->
{% include 'partials/confirm_modal.html' with modal_id='confirmScheduleChange' title='Confirm Schedule Change' body='Changing start date, billing cycle, or duration will delete all existing payments for this subscription and reset the schedule. This cannot be undone. Continue?' confirm_label='Yes, reset payments' confirm_class='btn-danger' %} 
{% endblock %} {% block extra_js %}

<script src="{% static 'js/subscription-forms.js' %}"></script>

{% endblock %}
